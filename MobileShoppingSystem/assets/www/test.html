
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>
<script type='text/javascript' src='knockoutjs.js'></script>
<script type='text/javascript' src="jquarry.js"></script>
	
</head>

<body>
    
    <table>
        <tr>
            <td>
                <button onclick="readJSON()">Load</button>
            </td>

        </tr>
    </table>
    

<table data-bind="foreach : items">
	<tr>
    <td> 
    <br>
    <br>
    	Name : <input data-bind="value:itemName"></input>
		Price : <input data-bind="value:itemPrice"></input>
    <br>
    <br>
    </td>	
    </tr>
</table>
<!--
<textarea data-bind="value:lastSavedJson">

</textarea>
-->

<input type="button" value="Save" data-bind="click:$root.save"></input>

<form id="sender" action="../JSONReader" method="post">
    <input id="data" type="text" name="content" value=""></input> 
</form>

<script type="text/javascript">    
    
var editorModel=function(){ 

	var self =this;
	self.items = ko.observableArray([new item(),new item()]);
	

	///////////////////// Jeson
	self.save = function() {
 //           self.lastSavedJson(JSON.stringify(ko.toJS(self), null, 2));
 //var jsonData = ko.toJSON(viewModel);
            document.getElementById("data").value=ko.toJSON(self);
            document.forms["sender"].submit();
        };
  //  self.lastSavedJson = ko.observable("")
	
	////////////////////
}


	 function item(){
		 var seg = this;
		 seg.itemName= ko.observable("test name");		 
		 seg.itemPrice= ko.observable("Rs 5/=");
		return this;

		}

	
        var modal = new editorModel();
        
        function readJSON(){
alert("new h2");
					$.get("http://10.0.2.2:8084/MSSServerApp/cp/testing", {},function(data){

						var parsed = eval("("+data+")");
						alert(data );	
                            modal.items([]);
                  //          document.getElementById("abc").innerHTML=document.getElementById("abc").innerHTML+"  "+parsed.items.length; 
                    
                            for(i=0;i<parsed.items.length;i++){
                                var seg = new item();
								seg.itemName(parsed.items[i].itemName);
                                seg.itemPrice(parsed.items[i].itemPrice);
                                modal.items.push(seg);
                            }
				    });
        			};
           
                    
	ko.applyBindings(modal);
	
</script>
</body>
</html>

